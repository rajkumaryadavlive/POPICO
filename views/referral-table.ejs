<% if(session.wallet){ %>
  <%- include('header') %>
    <% }else{ %>
      <%- include('uheader') %>
        <% }%>


          <div class="heading-row mb-20">
            <div class="row align-item-center">
              <div class="col-lg-4">
                <h3 class="page-title"><span class="page-title-icon bg-gradient-primary text-white mr-2"><i
                      class="mdi mdi-account"></i></span> Referral <small>(All figures are in POP)</small> </h3>
              </div>


              <div class="col-lg-6 ml-auto">
                <div class="text-right">
                  <div>

                    <!-- <a href="javascript:;" class="btn btn-common bg-gradient-primary" data-toggle="modal"
                      data-target=".share-modal">SHARE</a> -->
                  </div>
                </div>
              </div>

            </div>

          </div>


          <div class="row">
            <div class="col-lg-5 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <div class="row align-item-center">
                    <div class="col-lg-4">
                      <h6 class="m-0"> Refer your friends with this code</h6>
                    </div>

                    <div class="col-lg-8">
                      <div class="text-right create-wallet-block">


                        <div class="input-group input-dash copy-id-dash m-0">
                          <input class="form-control" type="text" id="address" name="address" value="<%=ref_code%>"
                            readonly>
                          <a onclick="myFunction()" href="javascript:void(0);"><i class="fa fa-copy"></i></a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-7 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <div class="row align-item-center">
                    <div class="col-lg-3">
                      <h6 class="m-0"> Or send this link</h6>
                    </div>
                    <div class="col-lg-9">
                      <div class="text-right create-wallet-block">
                        <div class="input-group input-dash copy-id-dash m-0">
                          <input class="form-control" type="text" id="addresslink" name="addresslink"
                            value="http://139.59.3.184/signup?code=<%=ref_code%>" readonly>
                          <a onclick="myFunction2()" href="javascript:void(0);"><i class="fa fa-copy"></i></a>
                          <!-- <a href="javascript:void(0);" data-toggle="modal" data-target=".share-modal"><i
                              class="mdi mdi-share-variant"></i></a> -->
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- 
  <div id="fb-root"></div>
  <div class="fb-share-button" data-href="https://theartwcoin.com/signup?code=4sa5v4XB2A" data-layout="button_count" data-size="small">
    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://theartwcoin.com/signup?code=4sa5v4XB2A&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div> -->

          <!-- <a href="javascript:;" class="sslinks twitter"  data-toggle="modal" data-target=".share-modal">
      Share
    </a> -->

          <div class="modal fade share-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
            aria-hidden="true">
            <!-- <div class="modal fade share-modal show" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" style="display: block; padding-right: 17px;" aria-modal="true"> -->
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <!-- <div class="modal-header">
                  <h5 class="modal-title" id="mySmallModalLabel">Share on</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                  </button>
                </div> -->
                <div class="modal-body">
                  <div class="container-fluid">
                    <div class="row">
                      <div class="col-md-3 col-6 mb-3">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://theartwcoin.com/signup?code=<%=ref_code%>"
                          title="Facebook" target="_blank" class="social-share text-muted d-block text-center h6">
                          <i class="fab fa-facebook-square facebook-btn"></i>
                          <span class="btn-block mt-3">Facebook</span>
                        </a>
                      </div>
                      <div class="col-md-3 col-6 mb-3">
                        <a href="https://twitter.com/intent/tweet?url=https://theartwcoin.com/signup?code=<%=ref_code%>"
                          data-url="https://theartwcoin.com/signup?code=<%=ref_code%>"
                          class="social-share text-muted d-block text-center h6" target="_blank" title="Twitter">
                          <i class="fab fa-twitter twitter-btn"></i> <span class="btn-block mt-3">Twitter</span>
                        </a>
                      </div>
                      <!-- <div class="col-md-3 col-6 mb-3">
                  <a href="fb-messenger://share/?link=https://theartwcoin.com/signup?code=<%=ref_code%>&amp;app_id=APP_ID" class="social-share text-muted d-block text-center h6" title="Facebook Messenger">
                  <i class="fab fa-facebook-messenger fb-messenger"></i> <span class="btn-block mt-3">Messenger</span>
                </a>
              </div> -->
                      <!-- <div class="col-md-3 col-6 mb-3">
                  <a href="whatsapp://send?text=https://theartwcoin.com/signup?code=<%=ref_code%>" data-action="share/whatsapp/share" class="social-share text-muted d-block text-center h6" title="WhatsApp">
                    <i class="fab fa-whatsapp btn-whatsapp"></i> <span class="btn-block mt-3">WhatsApp</span>
                  </a>
                </div> -->
                      <div class="col-md-3 col-6 mb-3">
                        <a href="https://telegram.me/share/url?url=https://theartwcoin.com/signup?code=<%=ref_code%>&amp;text=Easiest way to buy/sell 100s of NFTs and Artwork. Signup on theartwcoin.com to get $10 worth FREE ARTW as signup bonus and extra referral bonus of $5 worth FREE ARTW when you put in my referral code.   Direct Link -- https://theartwcoin.com/signup?code=<%=ref_code%>   Code - <%=ref_code%>"
                          target="_blank" class="social-share text-muted d-block text-center h6" title="Telegram">
                          <i class="fab fa-telegram-plane btn-telegram"></i> <span
                            class="btn-block mt-3">Telegram</span></a>
                      </div>
                      <div class="col-md-3 col-6 mb-3">
                        <a href="mailto:?subject=ARTW Referral&amp;body=Easiest way to buy/sell 100s of NFTs and Artwork. Signup on theartwcoin.com to get $10 worth FREE ARTW as signup bonus and extra referral bonus of $5 worth FREE ARTW when you put in my referral code.<br><br>\n\n
                  Direct Link -- https://theartwcoin.com/signup?code=<%=ref_code%><br><br>\n\n
                  Code - <%=ref_code%>" class="social-share text-muted d-block text-center h6" title="Email">
                          <i class="far fa-envelope"></i> <span class="btn-block mt-3">Email</span>
                        </a>
                      </div>
                      <!-- <div class="col-md-3 col-6 mb-3">
                  <a href="sms://?body=Check this https://theartwcoin.com/signup?code=<%=ref_code%>" class="social-share text-muted d-block text-center h6" title="Text message">
                    <i class="fa fa-sms"></i> <span class="btn-block mt-3">Text message</span>
                  </a>
                </div> -->
                      <!-- <div class="col-md-3 col-6 mb-3">
                  <a data-toggle="modal" data-target="#embedModal" href="#" class="social-share text-muted d-block text-center h6" title="Embed">
                  <i class="fa fa-code"></i> <span class="btn-block mt-3">Embed</span>
                </a>
              </div> -->
                    </div>

                  </div>


                  <div class="form-inline">
                    <div class="text-right create-wallet-block">

                      <div class="input-group input-dash copy-id-dash m-0">
                        <input style="max-width: 418px;" type="text" readonly="readonly" id="url_campaign"
                          class="form-control w-100 bg-white"
                          value="Easiest way to buy/sell 100s of NFTs and Artwork. Signup on theartwcoin.com to get $10 worth FREE ARTW as signup bonus and extra referral bonus of $5 worth FREE ARTW when you put in my referral code.   Direct Link -- https://theartwcoin.com/signup?code=<%=ref_code%>   Code - <%=ref_code%> ">
                        <a onclick="myFunction3()" href="javascript:void(0);"><i class="fa fa-copy"></i></a>
                      </div>
                    </div>
                    <!-- <input type="text" readonly="readonly" id="url_campaign" class="form-control w-100 bg-white" value="Easiest way to buy/sell 100s of NFTs and Artwork. Signup on theartwcoin.com to get $10 worth FREE ARTW as signup bonus and extra referral bonus of $5 worth FREE ARTW when you put in my referral code.   Direct Link -- https://theartwcoin.com/signup?code=<%=ref_code%>   Code - <%=ref_code%>">
                  <a onclick="myFunction3()" href="javascript:void(0);"><i class="fa fa-copy"></i></a> -->
                    <!-- <button class="btn btn-primary no-hover ml-1 btn-absolute" onclick="copyToClipboard('url_campaign')" >Copy Link</button> -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-header">
                  <div class="row">
                    <!-- <div class="col-md-2">
              <div class="form-group">
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon1">From</span>
                  </div>
                  <input type="text" class="form-control" id="datepicker" placeholder="Date">
                </div>
              </div>
            </div> -->
                    <div class="col-md-3">
                      <div class="form-group">
                        <div class="input-group mb-3">
                          <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon1">Date</span>
                          </div>
                          <input type="date" class="form-control" id="by_date" name="by_date"
                            onchange="get_users_by_date(this.value)" placeholder="Date">
                        </div>
                      </div>
                    </div>
                    <!-- <div class="col-md-3">
              <div class="form-group">
                <select class="form-control select-new" id="by_email_refer" name="by_email_refer">
                  <option value="">Select Email Address</option>
                  <option value="all">All</option>
                </select>
              </div>
            </div> -->

                  </div>
                </div>
                <div class="card-body table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th width="10%" class="border-top-0">S.No</th>
                        <th width="15%" class="border-top-0">Date</th>
                        <th width="15%" class="border-top-0">Referred By</th>
                        <th width="15%" class="border-top-0">Referred To</th>
                        <!-- <th width="15%" class="border-top-0">Register Date</th> -->
                        <th width="10%" class="border-top-0"><span class="green-text">Earned</span></th>
                        <!-- <th width="10%" class="border-top-0"><span class="orange-text">Spent</span></th>
                <th width="10%" class="border-top-0">Balance</th> -->
                      </tr>
                    </thead>
                    <tbody id="user_tr">
                      <input type="text" value="<%-ref_code%>" name="code" id="code" hidden>
                      <% for(var i=0; i<referrals.length; i++){ %>
                        <tr>
                          <td width="10%">
                            <%= i+1 %>
                          </td>
                          <td width="15%">
                            <%=referrals[i].created_at%>
                          </td>
                          <td width="15%">
                            <%= referrals[i].email2 %>
                          </td>
                          <td width="15%">
                            <%= referrals[i].email %>
                          </td>
                          <!-- <td width="15%"><%= i+1 %></td> -->
                          <td width="10%">5 POP</td>
                          <!-- <td width="10%">1000 ATRW</td>
                <td width="10%">1000 ATRW</td> -->
                        </tr>

                        <% } %>


                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <%- include('footer') %>
            <script>
              $(document).ready(function () {
                $('.table').DataTable();
              });

              $(document).ready(function () {
                let code = $('#code').val();
                $.ajax({
                  type: "post",
                  url: "/get-email",
                  data: { code: code },
                  success: function (data) {
                    data.txs.forEach(element => {
                      if (element) {
                        // alert(element);
                        $('#by_email_refer').append(`<option value="${element}">${element}</option>`);
                      }
                    });
                  }
                });
              });
            </script>
            <script type="text/javascript">
              function myFunction() {
                var copyText = document.getElementById("address");
                if ($('#address').val() != "") {
                  copyText.select();
                  document.execCommand("copy");
                  alert("Code Copied.");
                }
              }

              function myFunction2() {
                var copyText = document.getElementById("addresslink");
                if ($('#addresslink').val() != "") {
                  copyText.select();
                  document.execCommand("copy");
                  alert("Link Copied.");
                }
              }

              function myFunction3() {
                var copyText = document.getElementById("url_campaign");
                if ($('#url_campaign').val() != "") {
                  copyText.select();
                  document.execCommand("copy");
                  alert("Text Message Copied.");
                }
              }


              function get_users_by_date(value) {
                let code = $('#code').val();
                let date = value;
                $('#user_tr').html(" ");
                $.ajax({
                  type: "post",
                  url: "/refs-by-date",
                  data: { date: date, code: code },
                  success: function (data) {
                    if (data) {
                      var i = 0;
                      $('#user_tr').html(" ");
                      data.txs.forEach(element => {
                        if (element) {
                          $('#user_tr').append(`<tr><td>${i + 1}</td>
                      <td>${element.created_at}</td>
                      <td>${element.email2}</td>
                      <td>${element.email}</td></tr>`);
                          i++;
                        }
                      });
                    }
                  }
                });
              }

            </script>